/*
 * excelcsv
 *
 * Copyright (c) 2014 Jason Pescione
 * Licensed under the MIT license.
 *
 * @file Mocha tests for ExcelCSV.
 *
 */

'use strict';

/*jshint expr: true*/

var ExcelCSV = require('../lib/excelcsv.js')
  , fs       = require('fs');

describe('ExcelCSV unit testing', function(){

  var excelcsv
    , options
    , header
    , cwd = process.cwd();

  beforeEach(function() {
    header  = ['id', 'email', 'address', 'city', 'state', 'zip'];
    excelcsv = new ExcelCSV( cwd + '/test/fixtures/example.xlsx' );
  });

  afterEach(function() {
    excelcsv = null;
  });

  describe('._diffXCoordinates', function () {

    it('should return 1 given coordinates A1 and B1.', function() {
      excelcsv._diffXCoordinates( 'A1', 'B1' ).should.equal(1);
    });

    it('should return 1 given coordinates Z1 and AA1', function() {
      excelcsv._diffXCoordinates( 'Z1', 'AA1' ).should.equal(1);
    });

    it('should return 28 given coordinates A1 and AB1', function() {
      excelcsv._diffXCoordinates( 'A1', 'AB1' ).should.equal(27);
    });

  });

  describe('._incrementXcoordinate', function () {
    it('should return B given A', function() {
      excelcsv._incrementXcoordinate('A', 1).should.equal('B');
    });

    it('should return AA given Z', function() {
      excelcsv._incrementXcoordinate('Z', 1).should.equal('AA');
    });

    it('should return BB given AZ', function() {
      excelcsv._incrementXcoordinate('AZ', 2).should.equal('BB');
    });


  });


});
